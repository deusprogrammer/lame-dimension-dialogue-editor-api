let express,jsonwebtoken,authConfig,Users;_517‍.w("express",[["default",["express"],function(v){express=v}]]);_517‍.w("jsonwebtoken",[["default",["jsonwebtoken"],function(v){jsonwebtoken=v}]]);_517‍.w("../config/authConfig",[["default",["authConfig"],function(v){authConfig=v}]]);_517‍.w("../models/user",[["default",["Users"],function(v){Users=v}]]);




const router = express.Router();

router.post('/', async (req, res, next) => {
    const user = await Users.findOne({ username: req.body.username });
    if (!user || !user.isValidPassword(req.password)) {
        res.statusCode(401);
        return;
    }

    const body = {
        _id: user._id,
        username: user.username,
        roles: user.roles,
    };
    const jwtToken = jsonwebtoken.sign({ user: body }, authConfig.key);

    res.json({
        jwtToken
    });
    return;
});

module.exports = router;
